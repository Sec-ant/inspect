import{at as ee,d as te,as as oe,c as ne,j as N,o as k,aj as x,g as l,f as ae,b as u,u as s,m,p as S,n as A,h as f}from"./index-89bd64bf.js";import{b,h as z,o as U,f as P,i as H,j as I,p as $,e as q,a as _,g as V}from"./storage-b53c4e07.js";import{i as se,a as ie,J as M}from"./file_type-74916a33.js";import{u as L,c as E,a as J,b as j}from"./task-b0835956.js";var G={exports:{}};(function(t,e){(function(i,r){r()})(b,function(){function i(o,n){return typeof n>"u"?n={autoBom:!1}:typeof n!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function r(o,n,w){var a=new XMLHttpRequest;a.open("GET",o),a.responseType="blob",a.onload=function(){g(a.response,n,w)},a.onerror=function(){console.error("could not download file")},a.send()}function h(o){var n=new XMLHttpRequest;n.open("HEAD",o,!1);try{n.send()}catch{}return 200<=n.status&&299>=n.status}function d(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(n)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof b=="object"&&b.global===b?b:void 0,v=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!v?function(o,n,w){var a=c.URL||c.webkitURL,p=document.createElement("a");n=n||o.name||"download",p.download=n,p.rel="noopener",typeof o=="string"?(p.href=o,p.origin===location.origin?d(p):h(p.href)?r(o,n,w):d(p,p.target="_blank")):(p.href=a.createObjectURL(o),setTimeout(function(){a.revokeObjectURL(p.href)},4e4),setTimeout(function(){d(p)},0))}:"msSaveOrOpenBlob"in navigator?function(o,n,w){if(n=n||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(i(o,w),n);else if(h(o))r(o,n,w);else{var a=document.createElement("a");a.href=o,a.target="_blank",setTimeout(function(){d(a)})}}:function(o,n,w,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),typeof o=="string")return r(o,n,w);var p=o.type==="application/octet-stream",Y=/constructor/i.test(c.HTMLElement)||c.safari,D=/CriOS\/[\d]+/.test(navigator.userAgent);if((D||p&&Y||v)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var y=T.result;y=D?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=y:location=y,a=null},T.readAsDataURL(o)}else{var F=c.URL||c.webkitURL,R=F.createObjectURL(o);a?a.location=R:location.href=R,a=null,setTimeout(function(){F.revokeObjectURL(R)},4e4)}});c.saveAs=g.saveAs=g,t.exports=g})})(G);var B=G.exports;const X="https://github.com/gkd-kit/inspect/issues/new",re="661952005",C={origin:"https://github.com",referer:X},le=async()=>{var h;const t='[data-upload-policy-url="/upload/policies/assets"] input.js-data-upload-policy-url-csrf',e=await z(X);return(h=new DOMParser().parseFromString(await e.text(),"text/html").querySelector(t))==null?void 0:h.getAttribute("value")},K=async(t,e)=>{const[i,r]=(()=>{if(se(t))return[e||"file.png","image/png"];if(ie(t))return[e||"file.zip","application/x-zip-compressed"];throw new Error("invalid buffer, it must be png or zip")})(),h=await le();if(!h)throw ee.githubErrorDlgVisible=!0,new Error("failed get csrfToken");const d=await z("https://github.com/upload/policies/assets",{method:"POST",body:U({authenticity_token:h,content_type:r,name:i,size:t.byteLength,repository_id:re}),headers:C}).then(g=>{if(!g.ok)throw new Error("failed upload policies assets");return g.json()});if(!(await z(d.upload_url,{method:"POST",body:U(d.form,{file:new File([t],i,{type:r})}),headers:C})).ok)throw new Error("upload s3 failed");if((await z(new URL(d.asset_upload_url,"https://github.com/").href,{method:"PUT",body:U({authenticity_token:d.asset_upload_authenticity_token}),headers:{...C,Accept:"application/json"}})).status!=200)throw new Error("failed check authenticity upload");return d.asset},O=async t=>{const e=new M;return e.file("snapshot.json",JSON.stringify(t)).file("screenshot.png",await q.getItem(t.id)),await e.generateAsync({type:"blob",compression:"STORE"})},ce=async t=>{const e=`snapshot-${t.id}.zip`;B.saveAs(await O(t),e)},Z=async t=>{const e=await q.getItem(t.id);return new Blob([e,JSON.stringify(t)])},pe=async t=>{const e=`snapshot-${t.id}.png`;B.saveAs(await Z(t),e)},ke=async t=>{const e=new M;for(const r of t)await P(),e.file(r.id+".png",Z(r));const i=await e.generateAsync({type:"blob",compression:"STORE"});B.saveAs(i,`batch-png-${t.length}.zip`)},be=async t=>{const e=new M;for(const r of t)await P(),e.file(r.id+".zip",await O(r));const i=await e.generateAsync({type:"blob",compression:"STORE"});B.saveAs(i,`batch-zip-${t.length}.zip`)},W=async t=>H[t.id]??K(await Z(t).then(e=>e.arrayBuffer())).then(e=>(H[t.id]=e.href,e.href)),Q=async t=>I[t.id]??K(await O(t).then(e=>e.arrayBuffer())).then(e=>(I[t.id]=e.href,e.href)),_e=async t=>{const e=$(3);return(await Promise.allSettled(t.map(i=>e(()=>W(i))))).reduce((i,r)=>(r.status=="fulfilled"&&i.push(r.value),i),[])},xe=async t=>{const e=$(3);return(await Promise.allSettled(t.map(i=>e(()=>Q(i))))).reduce((i,r)=>(r.status=="fulfilled"&&i.push(r.value),i),[])},ue=["href"],de=f("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},[f("path",{d:"M549.973333 128 633.6 145.066667 474.026667 896 390.4 878.933333 549.973333 128M835.84 512 682.666667 358.826667 682.666667 238.08 956.586667 512 682.666667 785.493333 682.666667 664.746667 835.84 512M67.413333 512 341.333333 238.08 341.333333 358.826667 188.16 512 341.333333 664.746667 341.333333 785.493333 67.413333 512Z"})],-1),fe=f("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[f("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[f("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"}),f("path",{d:"M7 11l5 5l5-5"}),f("path",{d:"M12 4v12"})])],-1),he=f("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[f("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81c1.66 0 3-1.34 3-3s-1.34-3-3-3s-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65c0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z",fill:"currentColor"})],-1),we=f("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[f("g",{fill:"none"},[f("path",{d:"M12 1.75a3.25 3.25 0 0 1 3.245 3.066L15.25 5h5.25a.75.75 0 0 1 .102 1.493L20.5 6.5h-.796l-1.28 13.02a2.75 2.75 0 0 1-2.561 2.474l-.176.006H8.313a2.75 2.75 0 0 1-2.714-2.307l-.023-.174L4.295 6.5H3.5a.75.75 0 0 1-.743-.648L2.75 5.75a.75.75 0 0 1 .648-.743L3.5 5h5.25A3.25 3.25 0 0 1 12 1.75zm6.197 4.75H5.802l1.267 12.872a1.25 1.25 0 0 0 1.117 1.122l.127.006h7.374c.6 0 1.109-.425 1.225-1.002l.02-.126L18.196 6.5zM13.75 9.25a.75.75 0 0 1 .743.648L14.5 10v7a.75.75 0 0 1-1.493.102L13 17v-7a.75.75 0 0 1 .75-.75zm-3.5 0a.75.75 0 0 1 .743.648L11 10v7a.75.75 0 0 1-1.493.102L9.5 17v-7a.75.75 0 0 1 .75-.75zm1.75-6a1.75 1.75 0 0 0-1.744 1.606L10.25 5h3.5A1.75 1.75 0 0 0 12 3.25z",fill:"currentColor"})])],-1),Se=te({__name:"ActionCard",props:{snapshot:{},onDelete:{type:Function,default:()=>()=>{}},showPreview:{type:Boolean,default:!0},showExport:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},showShare:{type:Boolean,default:!0}},setup(t){const e=t,i=oe(),r=L(async()=>pe(await _.getItem(e.snapshot.id))),h=L(async()=>ce(await _.getItem(e.snapshot.id))),d=ne(()=>i.resolve({name:"snapshot",params:{snapshotId:e.snapshot.id}}).href),c=L(async()=>{const o=await W(await _.getItem(e.snapshot.id));N({title:"分享链接",content:V(o)})}),v=L(async()=>{const o=await Q(await _.getItem(e.snapshot.id));N({title:"分享链接",content:V(o)})}),g=async()=>{await _.removeItem(e.snapshot.id),await P(500),e.onDelete()};return(o,n)=>(k(),x(s(j),null,{default:l(()=>[o.showPreview?(k(),ae("a",{key:0,target:"_blank",href:d.value},[u(s(m),{size:"small"},{icon:l(()=>[u(s(E),null,{default:l(()=>[de]),_:1})]),_:1})],8,ue)):S("",!0),o.showExport?(k(),x(s(J),{key:1},{trigger:l(()=>[u(s(m),{size:"small"},{icon:l(()=>[u(s(E),null,{default:l(()=>[fe]),_:1})]),_:1})]),default:l(()=>[u(s(j),{vertical:""},{default:l(()=>[u(s(m),{onClick:s(r).invoke,loading:s(r).loading},{default:l(()=>[A(" 下载-png ")]),_:1},8,["onClick","loading"]),u(s(m),{onClick:s(h).invoke,loading:s(h).loading},{default:l(()=>[A(" 下载-zip ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})):S("",!0),o.showShare?(k(),x(s(J),{key:2},{trigger:l(()=>[u(s(m),{size:"small"},{icon:l(()=>[u(s(E),null,{default:l(()=>[he]),_:1})]),_:1})]),default:l(()=>[u(s(j),{vertical:""},{default:l(()=>[u(s(m),{onClick:s(c).invoke,loading:s(c).loading},{default:l(()=>[A(" 生成链接-png ")]),_:1},8,["onClick","loading"]),u(s(m),{onClick:s(v).invoke,loading:s(v).loading},{default:l(()=>[A(" 生成链接-zip ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})):S("",!0),o.showDelete?(k(),x(s(m),{key:3,size:"small",onClick:g},{icon:l(()=>[u(s(E),null,{default:l(()=>[we]),_:1})]),_:1})):S("",!0)]),_:1}))}});export{Se as _,be as a,ke as b,_e as c,xe as d};
//# sourceMappingURL=ActionCard.vue_vue_type_script_setup_true_lang-438adfc7.js.map
