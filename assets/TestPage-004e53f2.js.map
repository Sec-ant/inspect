{"version":3,"file":"TestPage-004e53f2.js","sources":["../../src/views/TestPage.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { Directive, nextTick, onMounted, ref, watchEffect } from 'vue';\n\nconst child = ref<HTMLElement[]>();\nconst weakset = new WeakSet<HTMLElement>();\nwatchEffect(() => {\n  if (!child.value) return;\n  const children = child.value;\n  children.forEach((div) => {\n    if (weakset.has(div)) return;\n    weakset.add(div);\n    const parent = div.parentElement! as HTMLElement & { __factor: number };\n    parent.__factor = 1;\n    const resize = () => {\n      console.log(div);\n      if (parent.scrollWidth > parent.clientWidth) {\n        parent.__factor++;\n        parent.style.width = `calc(100% / 6 * ${parent.__factor})`;\n      }\n    };\n    div.addEventListener('resize', resize);\n    resize();\n  });\n});\n\nconst vResize: Directive<HTMLElement & { __factor: number }> = {\n  async updated(div) {\n    console.log(div);\n    await nextTick();\n    div.__factor ??= 1;\n    if (div.scrollWidth > div.clientWidth) {\n      div.__factor++;\n      div.style.width = `calc(100% / 6 * ${div.__factor})`;\n    }\n  },\n  // mounted(div) {\n  // },\n  beforeUpdate(div) {\n    console.log(div);\n  },\n};\n\nconst text = ref(``);\nsetTimeout(() => {\n  text.value = `z`.repeat(100);\n}, 2000);\n</script>\n<template>\n  <div flex flex-wrap w-full>\n    <div\n      v-for=\"i in 9\"\n      :key=\"i\"\n      class=\"w-1/6\"\n      border-1px\n      border-solid\n      border-black\n      box-border\n      flex\n      flex-col\n      v-resize\n    >\n      hello{{ i }}\n      <div v-if=\"i == 1\">{{ text }}</div>\n      <div v-if=\"i == 4\" w-400px>zzzz</div>\n      <div v-if=\"i == 5\" w-350px>zzzz</div>\n    </div>\n  </div>\n</template>\n"],"names":["child","ref","weakset","watchEffect","div","parent","resize","vResize","nextTick","text"],"mappings":"iQAGA,MAAMA,EAAQC,IACRC,MAAc,QACpBC,EAAY,IAAM,CAChB,GAAI,CAACH,EAAM,MAAO,OACDA,EAAM,MACd,QAASI,GAAQ,CACpB,GAAAF,EAAQ,IAAIE,CAAG,EAAG,OACtBF,EAAQ,IAAIE,CAAG,EACf,MAAMC,EAASD,EAAI,cACnBC,EAAO,SAAW,EAClB,MAAMC,EAAS,IAAM,CACnB,QAAQ,IAAIF,CAAG,EACXC,EAAO,YAAcA,EAAO,cACvBA,EAAA,WACAA,EAAA,MAAM,MAAQ,mBAAmBA,EAAO,YACjD,EAEED,EAAA,iBAAiB,SAAUE,CAAM,EAC9BA,GAAA,CACR,CAAA,CACF,EAED,MAAMC,EAAyD,CAC7D,MAAM,QAAQH,EAAK,CACjB,QAAQ,IAAIA,CAAG,EACf,MAAMI,EAAS,EACfJ,EAAI,WAAJA,EAAI,SAAa,GACbA,EAAI,YAAcA,EAAI,cACpBA,EAAA,WACAA,EAAA,MAAM,MAAQ,mBAAmBA,EAAI,YAE7C,EAGA,aAAaA,EAAK,CAChB,QAAQ,IAAIA,CAAG,CACjB,CAAA,EAGIK,EAAOR,EAAI,EAAE,EACnB,kBAAW,IAAM,CACVQ,EAAA,MAAQ,IAAI,OAAO,GAAG,GAC1B,GAAI"}